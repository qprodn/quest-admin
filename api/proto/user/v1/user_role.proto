syntax = "proto3";

package system.user.v1;

import "google/api/annotations.proto";
import "google/protobuf/empty.proto";
import "openapi/v3/annotations.proto";

option go_package = "quest-admin/api/user/v1;v1";


option (openapi.v3.document) = {
  tags: [
    {
      name: "UserRoleService";
      description: "用户角色关联相关操作";
    }
  ];
};

service UserRoleService {
  // 管理用户角色
  rpc ManageUserRoles (ManageUserRolesRequest) returns (google.protobuf.Empty) {
    option (google.api.http) = {
      put: "/api/v1/users/{id}/roles"
      body: "*"
    };
    option (openapi.v3.operation) = {
      summary: "管理用户角色";
      description: "为用户分配或移除角色，管理用户的角色信息";
    };
  }

  // 获取用户角色列表
  rpc GetUserRoles (GetUserRolesRequest) returns (GetUserRolesReply) {
    option (google.api.http) = {
      get: "/api/v1/users/{id}/roles"
    };
    option (openapi.v3.operation) = {
      summary: "获取用户角色列表";
      description: "获取用户已分配的角色列表";
    };
  }
}

message ManageUserRolesRequest {
  option (openapi.v3.schema) = {
    description: "管理用户角色请求体";
  };
  optional string id = 1 [(openapi.v3.property) = {description: "用户ID"; example: {yaml: "123456789"};}];
  repeated string role_ids = 2 [(openapi.v3.property) = {description: "角色ID列表";}];
  optional string operation = 3 [(openapi.v3.property) = {description: "操作类型: add-添加, remove-移除, replace-替换"; example: {yaml: "add"};}];
}

message GetUserRolesRequest {
  option (openapi.v3.schema) = {
    description: "获取用户角色列表请求体";
  };
  optional string id = 1 [(openapi.v3.property) = {description: "用户ID"; example: {yaml: "123456789"};}];
}

message GetUserRolesReply {
  option (openapi.v3.schema) = {
    description: "获取用户角色列表响应体";
  };
  repeated string role_ids = 1 [(openapi.v3.property) = {description: "角色ID列表";}];
}
